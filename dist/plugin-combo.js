(function(k){function r(b){for(var c={__KEYS:[]},e=0,d=b.length;e<d;e++)for(var g=b[e].replace("://","__").split("/"),a=c,f=0,h=g.length;f<h;f++){var l=g[f];a[l]||(a[l]={__KEYS:[]},a.__KEYS.push(l));a=a[l]}b=[];e=c.__KEYS;d=0;for(g=e.length;d<g;d++){a=f=e[d];f=c[f];for(h=f.__KEYS;1===h.length;)a+="/"+h[0],f=f[h[0]],h=f.__KEYS;h.length&&b.push([a.replace("__","://"),s(f)])}return b}function s(b){for(var c=[],e=b.__KEYS,d=0,g=e.length;d<g;d++){var a=e[d],f=s(b[a]),h=f.length;if(h)for(var l=0;l<h;l++)c.push(a+
"/"+f[l]);else c.push(a)}return c}function t(b){for(var c=0,e=b.length;c<e;c++){for(var d=b[c],g=d[0]+"/",a=d[1],d=[],f={},h=0,l=a.length;h<l;h++){var k=a[h],j;j=k;var m=j.lastIndexOf(".");(j=0<=m?j.substring(m):"")&&(f[j]||(f[j]=[])).push(k)}a=void 0;for(a in f)f.hasOwnProperty(a)&&d.push(f[a]);f=0;for(a=d.length;f<a;f++)p(g,d[f])}return n}function p(b,c){var e=b+m[0]+c.join(m[1]),d=e.length>q;if(1<c.length&&d){a:{for(var e=q-(b+m[0]).length,d=m[1],g=c[0],a=1,f=c.length;a<f;a++)if(g+=d+c[a],g.length>
e){e=[c.splice(0,a),c];break a}e=void 0}p(b,e[0]);p(b,e[1])}else{if(d)throw Error("The combo url is too long: "+e);d=0;for(g=c.length;d<g;d++)n[b+c[d]]=e}}function u(b){var c=j.comboSyntax||["??",","],e=c[0],c=c[1];return e&&0<b.indexOf(e)||c&&0<b.indexOf(c)}var v=k.Module,x=v.STATUS.FETCHING,j=k.data,n={},m=["??",","],q=2E3;k.on("load",function(b){var c=b.length;if(!(2>c)){j.comboSyntax&&(m=j.comboSyntax);j.comboMaxLength&&(q=j.comboMaxLength);for(var e=j.comboExcludes,d=[],g=0;g<c;g++){var a=b[g];
n[a]||v.get(a).status<x&&((!e||!e.test(a))&&!u(a))&&d.push(a)}1<d.length&&t(r(d))}});k.on("fetch",function(b){b.requestUri=n[b.uri]||b.uri});k.on("requested",function(b){b=b.requestUri;if(u(b))for(var c in n)n===b&&delete n[c]});if(j.test){var w=k.test||(k.test={});w.uris2paths=r;w.paths2hash=t}define(k.data.dir+"plugin-combo",[],{})})(seajs);
